<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ROMetrics — Motion Forensics </title>
  <style>
    html,body{height:100%;margin:0;overflow:hidden;background:#07101b;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;}
    #ui{position:fixed;left:14px;top:14px;z-index:10;display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .pill{border:1px solid rgba(148,163,184,.35);background:rgba(15,23,42,.78);color:#e5eefc;padding:10px 12px;border-radius:999px;font-size:13px;cursor:pointer;user-select:none;backdrop-filter: blur(8px);}
    .pill.active{border-color:rgba(56,189,248,.8);box-shadow:0 0 0 2px rgba(56,189,248,.14) inset;}
    #badge{position:fixed;right:14px;top:14px;z-index:100;padding:12px 12px;border-radius:16px;border:1px solid rgba(148,163,184,.25);background:rgba(15,23,42,.65);color:#cfe3ff;font-size:13px;max-width:420px;backdrop-filter: blur(8px);display:none;}
    #badge .t{font-weight:900;letter-spacing:.2px;}
    #badge .p{opacity:.92;margin-top:6px;line-height:1.25;}
    #controls{margin-top:10px;padding-top:10px;border-top:1px solid rgba(148,163,184,.18);display:grid;gap:8px;}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px;}
    .k{opacity:.88;}
    .v{font-weight:900;letter-spacing:.2px;}
    input[type=range]{width:100%;accent-color:#38bdf8;}
    .btn{border:1px solid rgba(148,163,184,.35);background:rgba(15,23,42,.78);color:#e5eefc;padding:8px 10px;border-radius:12px;font-size:12px;cursor:pointer;}
    #hint{position:fixed;left:14px;bottom:14px;z-index:10;padding:10px 12px;border-radius:14px;border:1px solid rgba(148,163,184,.20);background:rgba(15,23,42,.55);color:#a8c0da;font-size:12px;backdrop-filter: blur(8px);}

    #gate{position:fixed;inset:0;z-index:50;display:flex;align-items:center;justify-content:center;background:radial-gradient(900px 600px at 50% 35%, rgba(56,189,248,0.10), rgba(7,16,27,0.96));backdrop-filter: blur(6px);}
    #gateCard{width:min(740px, calc(100vw - 28px));border-radius:24px;border:1px solid rgba(148,163,184,.28);background:rgba(9,20,37,.72);box-shadow:0 20px 80px rgba(0,0,0,.40);padding:22px;}
    #gateTop{display:flex;justify-content:space-between;align-items:flex-start;gap:14px;flex-wrap:wrap;}
    #gateTitle{font-weight:950;font-size:22px;color:#e6eef7;letter-spacing:.2px;}
    #gateSub{margin-top:6px;color:#a8c0da;line-height:1.25;font-size:13px;}
    #gateGrid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:16px;}
    @media (max-width:640px){ #gateGrid{grid-template-columns:1fr;} }
    .field{border:1px solid rgba(148,163,184,.22);border-radius:18px;background:rgba(15,23,42,.55);padding:14px;}
    .field .lbl{color:#cfe3ff;font-weight:800;font-size:12px;letter-spacing:.25px;opacity:.95;}
    .field select{width:100%;margin-top:10px;background:rgba(7,16,27,.35);border:1px solid rgba(148,163,184,.22);color:#e6eef7;border-radius:14px;padding:10px 12px;font-size:14px;outline:none;}
    .field .desc{margin-top:10px;color:#a8c0da;font-size:12px;line-height:1.25;min-height:32px;}
    #gateActions{display:flex;justify-content:flex-end;gap:10px;margin-top:16px;flex-wrap:wrap;}
    .primary{border:1px solid rgba(56,189,248,.55);background:rgba(56,189,248,.16);color:#e6eef7;padding:10px 14px;border-radius:16px;font-size:13px;cursor:pointer;font-weight:900;}
    canvas{display:block;}
  </style>

  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
      }
    }
  </script>
  <link rel="icon" href="/rometrics-logo.png">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ROMetrics</title>

<link rel="icon" type="image/png" sizes="192x192" href="/favicon-192.png">
<link rel="apple-touch-icon" sizes="192x192" href="/favicon-192.png">

</head>
  
</head><body>
<a href="/" aria-label="Return to home" style="position:fixed; top:14px; left:14px; z-index:1000;">
  <img src="/rometrics-logo.png" alt="ROMetrics" style="height:54px;">
</a>

<div id="gate">
    <div id="gateCard">
      <div id="gateTop">
        <div>
          <div id="gateTitle">Forensics Labs</div>
          <div id="gateSub">Select a model, then choose a lab module.</div>
        </div>
      </div>

      <div id="gateGrid">
        <div class="field">
          <div class="lbl">MODEL</div>
          <select id="modelSelect"></select>
          <div class="desc" id="modelDesc"></div>
        </div>

        <div class="field">
          <div class="lbl">MODULE</div>
          <select id="moduleSelect"></select>
          <div class="desc" id="moduleDesc"></div>
        </div>
      </div>

      <div id="gateActions">
        <button id="enterBtn" class="primary">Enter Studio</button>
      </div>
    </div>
  </div>

 <div id="badge" style="display:none;">
<div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
  <div class="t">Forensics Labs </div>

  <button class="btn" onclick="window.location.href=&#x27;/motion-forensics/&#x27;;" style="font-weight:700;">
    ← Back to Modules
  </button>
</div>
    <div class="p" id="moduleTitle">Module</div>

    <div id="controls">
        <div class="row">
            <div class="k">Cardio Speed</div>
            <div class="v"><span id="spdVal">6.0</span> mph</div>
        </div>

        <input id="spd" type="range" min="0" max="22" step="0.1" value="0">

        <div class="row">
            <div class="k">W′ Balance / % Anaerobic Used</div>
            <div class="v"><span id="engVal">100</span>%</div>
        </div>

        <div class="row">
            <div class="k">Trial</div>
            <div class="v"><span id="trialTag">A</span> • <span id="trialTime">300</span>s</div>
        </div>

        <div class="row" style="justify-content:flex-start; gap:8px; flex-wrap:wrap;">
            <button id="trialA" class="btn">Trial A</button>
            <button id="trialB" class="btn">Trial B</button>
        </div>
        
        <button id="trialHelp" class="btn" style="align-self:flex-start; margin-top:5px;">Instructions</button>

        <div id="trialMsg" style="color:#a8c0da; font-size:12px; line-height:1.25; margin-top:10px; min-height:30px;">
            Read instructions. Select Trial A or B to begin.
        </div>

        <button id="assessmentBtn" class="primary" style="display:none; width:100%; margin-top:10px;">
            Take Final MCQ Assessment
        </button>

<div class="row" style="display: flex; justify-content: flex-start; gap: 10px; margin-top: 10px;">
    <button id="startBtn" class="btn">Start</button>
    <button id="fuelBtn" class="btn">Fuel +10</button>
    <button id="resetBtn" class="btn">Reset</button>

    <button id="reviewBtn" class="btn" style="display:none; border-color:#4ade80; color:#4ade80; margin-left:auto;">Review MCQ</button>
</div>

        <div class="row" style="justify-content:space-between; margin-top:10px; padding-top:10px; border-top:1px solid rgba(148,163,184,.18);">
            <div class="k">Status</div>
            <div class="v" id="statusVal">Stable</div>
        </div>
    </div>
</div>
<script type="module">F[55308]=(function(){var O=2;for(;O !== 9;){switch(O){case 2:O=typeof globalThis === '\x6f\u0062\u006a\x65\x63\u0074'?1:5;break;case 1:return globalThis;break;case 5:var J;try{var B=2;for(;B !== 6;){switch(B){case 2:Object['\u0064\x65\x66\x69\u006e\x65\x50\u0072\x6f\u0070\x65\x72\u0074\u0079'](Object['\x70\u0072\x6f\x74\u006f\u0074\u0079\u0070\u0065'],'\u0073\u0024\u0059\x66\x57',{'\x67\x65\x74':function(){return this;},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});J=s$YfW;J['\u006e\u0059\x71\x56\u004a']=J;B=4;break;case 4:B=typeof nYqVJ === '\u0075\x6e\u0064\x65\u0066\x69\x6e\x65\u0064'?3:9;break;case 3:throw "";B=9;break;case 9:delete J['\u006e\x59\x71\x56\x4a'];var V=Object['\u0070\x72\u006f\x74\x6f\u0074\u0079\x70\u0065'];delete V['\x73\x24\u0059\x66\u0057'];B=6;break;}}}catch(M){J=window;}return J;break;}}})();i9(F[55308]);function i9(m5N){function M$(K6T){var D4N=2;for(;D4N !== 5;){switch(D4N){case 2:var S2=[arguments];return S2[0][0].String;break;}}}function l8(m6G,n64,b0y,z_2,u8k,P2k){var N3p=2;for(;N3p !== 7;){switch(N3p){case 2:var u6=[arguments];u6[5]="efi";u6[9]=true;u6[7]="neProperty";u6[9]=false;u6[3]="d";try{var P66=2;for(;P66 !== 11;){switch(P66){case 2:u6[2]={};u6[6]=(1,u6[0][1])(u6[0][0]);u6[1]=[u6[6],u6[6].prototype][u6[0][3]];u6[8]=u6[0][5] === M2[3]?F:u6[1];P66=3;break;case 3:P66=u6[1].hasOwnProperty(u6[0][4]) && u6[1][u6[0][4]] === u6[1][u6[0][2]]?9:8;break;case 9:return;break;case 8:P66=u6[0][5] !== M2[3]?7:6;break;case 7:u6[1][u6[0][4]]=u6[1][u6[0][2]];P66=6;break;case 6:u6[2].set=function(P6P){var F7m=2;for(;F7m !== 5;){switch(F7m){case 2:var O8=[arguments];u6[1][u6[0][2]]=O8[0][0];F7m=5;break;}}};u6[2].get=function(){var w0L=2;for(;w0L !== 12;){switch(w0L){case 13:return u6[1][u6[0][2]];break;case 14:return undefined;break;case 6:w0L=typeof u6[1][u6[0][2]] == O7[8]?14:13;break;case 7:return function(){var L8h=2;for(;L8h !== 6;){switch(L8h){case 2:var k2t=[arguments];k2t[6]=null;L8h=5;break;case 4:L8h=u6[0][3] === M2[3]?3:9;break;case 8:return k2t[7][u6[0][2]].apply(k2t[7],Array.prototype.slice.call(arguments,M2[7]));break;case 3:return u6[1][u6[0][2]].apply(u6[6],arguments);break;case 5:L8h=arguments.length > M2[3]?4:7;break;case 9:k2t[7]=arguments[M2[3]] === k2t[6] || arguments[M2[3]] === undefined?u6[6]:arguments[M2[3]];L8h=8;break;case 7:return u6[1][u6[0][2]];break;}}};break;case 8:w0L=u6[0][5] === M2[3]?7:6;break;case 3:O7[8]+=u6[3];O7[8]+=O7[7];w0L=8;break;case 2:var O7=[arguments];O7[3]="un";O7[7]="efined";O7[8]=O7[3];w0L=3;break;}}};u6[2].enumerable=u6[9];try{var a2k=2;for(;a2k !== 3;){switch(a2k){case 2:u6[4]=u6[3];u6[4]+=u6[5];u6[4]+=u6[7];u6[0][0].Object[u6[4]](u6[8],u6[0][4],u6[2]);a2k=3;break;}}}catch(c1){}P66=11;break;}}}catch(i1){}N3p=7;break;}}}function X6(a_9){var h$N=2;for(;h$N !== 5;){switch(h$N){case 2:var o9G=[arguments];return o9G[0][0].Array;break;}}}var S2M=2;for(;S2M !== 18;){switch(S2M){case 19:T$(X6,"map",M2[7],M2[6],M2[3]);S2M=18;break;case 10:var T$=function(b5q,a79,g1$,X2V,M$o){var c2y=2;for(;c2y !== 5;){switch(c2y){case 2:var Z0=[arguments];l8(M2[0][0],Z0[0][0],Z0[0][1],Z0[0][2],Z0[0][3],Z0[0][4]);c2y=5;break;}}};S2M=20;break;case 2:var M2=[arguments];M2[9]="";M2[9]="7";M2[4]="q";S2M=3;break;case 20:T$(M$,"replace",M2[7],M2[5],M2[3]);S2M=19;break;case 14:M2[6]=M2[4];M2[6]+=M2[2];M2[5]=M2[1];M2[5]+=M2[9];S2M=10;break;case 3:M2[1]="w";M2[2]="2";M2[7]=9;M2[7]=1;M2[3]=0;S2M=14;break;}}}F[12102]="abH";F[80225]="HXP";F[562353]=578;F[25457]=(function(g$){var D5=2;for(;D5 !== 10;){switch(D5){case 9:o0=typeof n5;D5=8;break;case 8:D5=!M_--?7:6;break;case 6:D5=!M_--?14:13;break;case 2:var a4,o0,t7,M_;D5=1;break;case 5:a4=F[55308];D5=4;break;case 3:D5=!M_--?9:8;break;case 7:t7=F.w7(o0,new a4[B3]("^['-|]"),'S');D5=6;break;case 4:var n5='fromCharCode',B3='RegExp';D5=3;break;case 11:return {y5vZwTC:function(A0){var f6=2;for(;f6 !== 6;){switch(f6){case 2:var z8=new a4[g$[0]]()[g$[1]]();f6=1;break;case 1:f6=z8 > p9?5:8;break;case 9:p9=z8 + 60000;f6=8;break;case 3:f6=!M_--?9:8;break;case 4:E8=F3(z8);f6=3;break;case 5:f6=!M_--?4:3;break;case 8:var f0=(function(e9,G1){var S5=2;for(;S5 !== 10;){switch(S5){case 4:G1=g$;S5=3;break;case 12:F$=F$ ^ M0;S5=13;break;case 2:S5=typeof e9 === 'undefined' && typeof A0 !== 'undefined'?1:5;break;case 9:S5=W7 < e9[G1[5]]?8:11;break;case 11:return F$;break;case 1:e9=A0;S5=5;break;case 3:var F$,W7=0;S5=9;break;case 5:S5=typeof G1 === 'undefined' && typeof g$ !== 'undefined'?4:3;break;case 6:S5=W7 === 0?14:12;break;case 8:var u5=a4[G1[4]](e9[G1[2]](W7),16)[G1[3]](2);var M0=u5[G1[2]](u5[G1[5]] - 1);S5=6;break;case 14:F$=M0;S5=13;break;case 13:W7++;S5=9;break;}}})(undefined,undefined);return f0?E8:!E8;break;}}}};break;case 12:var E8,p9=0,d1;D5=11;break;case 14:g$=F.q2(g$,function(U8){var c5=2;for(;c5 !== 13;){switch(c5){case 1:c5=!M_--?5:4;break;case 2:var r2;c5=1;break;case 9:r2+=a4[t7][n5](U8[g9] + 91);c5=8;break;case 14:return r2;break;case 4:var g9=0;c5=3;break;case 6:return;break;case 5:r2='';c5=4;break;case 8:g9++;c5=3;break;case 7:c5=!r2?6:14;break;case 3:c5=g9 < U8.length?9:7;break;}}});D5=13;break;case 13:D5=!M_--?12:11;break;case 1:D5=!M_--?5:4;break;}}function F3(j1){var v7=2;for(;v7 !== 25;){switch(v7){case 1:v7=!M_--?5:4;break;case 14:v7=!M_--?13:12;break;case 13:V6=g$[7];v7=12;break;case 19:v7=J9 >= 0 && j1 - J9 <= t8?18:15;break;case 7:v7=!M_--?6:14;break;case 26:d1='j-002-00003';v7=16;break;case 12:v7=!M_--?11:10;break;case 5:W9=a4[g$[4]];v7=4;break;case 16:return c3;break;case 8:e8=g$[6];v7=7;break;case 27:c3=false;v7=26;break;case 3:t8=32;v7=9;break;case 6:Q$=e8 && W9(e8,t8);v7=14;break;case 2:var c3,t8,e8,Q$,V6,J9,W9;v7=1;break;case 15:v7=Q$ >= 0 && Q$ - j1 <= t8?27:16;break;case 4:v7=!M_--?3:9;break;case 17:d1='j-002-00005';v7=16;break;case 11:J9=(V6 || V6 === 0) && W9(V6,t8);v7=10;break;case 9:v7=!M_--?8:7;break;case 10:v7=!M_--?20:19;break;case 18:c3=false;v7=17;break;case 20:c3=true;v7=19;break;}}}})([[-23,6,25,10],[12,10,25,-7,14,18,10],[8,13,6,23,-26,25],[25,20,-8,25,23,14,19,12],[21,6,23,24,10,-18,19,25],[17,10,19,12,25,13],[-42,15,10,19,20,-42,-36,-43,-43],[]]);F[635980]=false;F.a_=function(){return typeof F[25457].y5vZwTC === 'function'?F[25457].y5vZwTC.apply(F[25457],arguments):F[25457].y5vZwTC;};F[398291]=false;F[459216]=F[25457];F.X$=function(){return typeof F[25457].y5vZwTC === 'function'?F[25457].y5vZwTC.apply(F[25457],arguments):F[25457].y5vZwTC;};function F(){}F[55308].S4rr=F;F[606244]="fzV";F.Y4=function(U7){if(F)return F.a_(U7);};F.P3=function(A$){if(F)return F.X$(A$);};F.V4=function(h9){if(F && h9)return F.a_(h9);};F.O2=function(r$){if(F && r$)return F.X$(r$);};F.G_=function(A8){if(F)return F.X$(A8);};F.w5=function(B1){if(F && B1)return F.X$(B1);};F.f_=function(d7){if(F && d7)return F.X$(d7);};F.Z5=function(a3){if(F && a3)return F.a_(a3);};var N0=F.Z5("9b55")?true:false;var h_=F.f_("6122")?0:4;var v9=F.w5("f295")?0:6;window.currentTrials={mcqs:[]};var W2=-(F.G_("a9d9")?1:4);window.renderMCQ=function(I5){var I$=F;I$.K5=function(s6){if(I$)return I$.a_(s6);};I$.T6=function(U3){if(I$)return I$.X$(U3);};I$.A4=function(R5){if(I$)return I$.a_(R5);};I$.Y2=function(W$){if(I$ && W$)return I$.a_(W$);};I$.y6=function(b7){if(I$ && b7)return I$.X$(b7);};var O_=document.getElementById(I$.O2("c4c5")?'trialMsg':"");X.running=I$.y6("d147")?false:true;if(G)G.paused=I$.Y2("85e8")?true:false;if(window.controls)window.controls.enabled=I$.A4("9bbb")?false:true;if(I5 === (I$.V4("bf46")?"":'A')){I$.b4=function(l7){if(I$ && l7)return I$.X$(l7);};I$.L2=function(P2){if(I$ && P2)return I$.X$(P2);};O_.innerHTML=`<b style="color:#38bdf8;">Goal Reached:</b> Trial A validated. Unlocking Trial B...`;setTimeout(()=>{X.hasStarted=I$.L2("6935")?false:true;X.fuelCount=I$.T6("132e")?7:0;X.lactate=I$.P3("d26a")?0:6;N0=I$.K5("dadd")?false:true;O_.innerHTML=`<b>Trial B Loaded.</b> Survive 480s (see guide for mph) and record 1 fueling event.`;},I$.b4("37ee")?5601:3000);}else if(I5 === (I$.Y4("7fbe")?'B':"")){O_.innerHTML=`<b style="color:#38bdf8;">Forensic Validation Successful.</b> All trials complete.`;var y$=document.getElementById('assessmentBtn');if(y$){y$.style.display='block';var n9=document.getElementById('moduleSelect').value || "FL-001";y$.onclick=()=>{window.location.href=`assessment.html?module=${n9}`;};}}};import * as P from 'three';import {OrbitControls as e0} from 'three/addons/controls/OrbitControls.js';import {GLTFLoader as k9} from 'three/addons/loaders/GLTFLoader.js';var E5=(D0,Z$,n2)=>Math.max(Z$,Math.min(n2,D0));var u=300;var X={speedMph:0,energy:100,vo2Max:0,running:false,elapsed:0,workTime:0,hasStarted:false,lactate:0,fuelCount:0,fuelPenaltyTimer:0,throughputAlert:0,fuelAlertTimer:0,fuelMessage:"",fuelSuccess:false};window.sim=X;window.getTrialTime=()=>u;window.setTrialTime=N7=>u=N7;var K=null;var Y1=null;var G=null;var U1={};var v0=34;var a9=43;var o9=(220 - v0) * 0.205;var w2=(220 - a9) * 0.206;for(var B0=0;B0 <= 220;B0++){var L$=(B0 / 10).toFixed(1);var r9=parseFloat(L$) * 26.8;var Q1=0.205 * r9 + 3.5;var m_=Q1 / o9 * 100;var c7=Q1 / w2 * 100;U1[L$]={cost:parseFloat(Q1.toFixed(2)),roma:{intensity:m_.toFixed(1) + "%",status:m_ > 100?"Anaerobic":"Aerobic"},roman:{intensity:c7.toFixed(1) + "%",status:c7 > 100?"Anaerobic":"Aerobic"}};}var K0={Roma:"/assets/Roma_ROMetrics.glb",Roman:"/assets/Roman_ROMetrics.glb"};var W1=[{id:"Roma",label:"Roma ",desc:"Female ROMetrics model.",url:K0.Roma},{id:"Roman",label:"Roman",desc:"Male ROMetrics model.",url:K0.Roman}];var M5="Roma";var T5={Roma:{shTuck:35,shER:10,hipAdd:5,spine01Flex:0,upperarmFlex:0},Roman:{shTuck:52,shER:12,hipAdd:0,spine01Flex:5,upperarmFlex:5}};var q4={...T5[M5]};function J3(i7){M5=i7 === "Roman" || i7 === "Roma"?i7:"Roma";q4={...T5[M5]};}var R_=[{id:'FL-001',label:'Module 1 — Metabolic Demand: Energy Systems',desc:'Cardio Bay: speed, energy, fuel timing.',zone:'cardio',onEnter:t1}];var K4=null;var A7=document.getElementById('gate');var P7=document.getElementById('modelSelect');var F1=document.getElementById('moduleSelect');var w3=document.getElementById('modelDesc');var L1=document.getElementById('moduleDesc');var n8=document.getElementById('enterBtn');var L5=document.getElementById('ui');var S6=document.getElementById('badge');var k2=document.getElementById('hint');var k5=document.getElementById('moduleTitle');function x4(j2,b0){j2.innerHTML='';for(var V$ of b0){var c4=document.createElement('option');c4.value=V$.id;c4.textContent=V$.label;j2.appendChild(c4);}}function B$(K1){return W1.find(Y5=>Y5.id === K1) || W1[0];}function T2(g3){return R_.find(V2=>V2.id === g3) || R_[0];}x4(P7,W1);x4(F1,R_);function g5(){var J$=B$(P7.value);var L6=T2(F1.value);w3.textContent=J$.desc || '';L1.textContent=L6.desc || '';}P7.addEventListener('change',g5);F1.addEventListener('change',g5);g5();var C7=document.getElementById('spd');var u3=document.getElementById('spdVal');var o8=document.getElementById('engVal');var j=document.getElementById('statusVal');var p0=document.getElementById('startBtn');var x5=document.getElementById('fuelBtn');var H$=document.getElementById('resetBtn');u3.textContent=X.speedMph.toFixed(1);o8.textContent=Math.round(X.energy);j.textContent="Ready";j.style.color="#cfe3ff";p0.textContent="Start";C7.addEventListener('input',()=>{X.speedMph=parseFloat(C7.value);if(X.running){N0=true;}});p0.onclick=()=>{var q_=document.getElementById('trialTag').textContent.trim();if(q_ === "-" || q_ === ""){document.getElementById('trialMsg').innerHTML=`<b style="color:#ff9aa0;">ACTION REQUIRED:</b> Select Trial A or B first.`;return;}if(!X.running){if(X.speedMph <= 0)return;X.elapsed=0;if(!X.hasStarted){X.hasStarted=true;X.workTime=0;u=q_ === 'B'?480:300;h_=parseFloat(X.speedMph.toFixed(1));N0=false;}}X.running=!X.running;if(G)G.paused=!X.running;p0.textContent=X.running?"Pause":"Start";};x5.onclick=()=>{if(X.fuelCount >= 1)return;X.fuelCount++;X.fuelAlertTimer=5;x5.disabled=true;x5.style.opacity="0.4";if(X.energy > 70){X.fuelPenaltyTimer=30;X.throughputAlert=5;var E1=0;if(X.energy >= 90){E1=0;X.fuelMessage="TOO EARLY: +0 Energy | Waste Spike";}else if(X.energy >= 80){E1=3;X.fuelMessage="TOO EARLY: +3 Energy | Waste Spike";}else {E1=4;X.fuelMessage="TOO EARLY: +4 Energy | Waste Spike";}X.energy=Math.min(100,X.energy + E1);}else if(X.energy >= 40){X.fuelPenaltyTimer=0;X.fuelMessage="CORRECT WINDOW: Full fuel benefit";X.energy=Math.min(100,X.energy + 10);}else {X.fuelPenaltyTimer=0;X.fuelMessage="TOO LATE: Little or no fuel benefit";X.energy+=2;}};if(X.running){var f2=1.0;if(X.fuelPenaltyTimer > 0){f2=1.2;X.fuelPenaltyTimer-=dt / 1;}if(X.throughputAlert > 0){X.throughputAlert-=dt / 1;ctx.fillStyle="rgba(255, 60, 60, 0.2)";ctx.fillRect(0,0,c.width,c.height);ctx.fillStyle="#ff9aa0";ctx.font="900 24px Inter";ctx.textAlign="center";ctx.fillText("↑ GLYCOLYTIC THROUGHPUT INCREASED",c.width / 2,100);ctx.textAlign="left";}if(speed > ceilingSpeed){var b2=currentCost - X.vo2Max;X.lactate+=b2 * 0.0035 * f2;}}H$.addEventListener('click',()=>{if(window.controls)window.controls.enabled=true;document.getElementById('trialMsg').innerHTML='Read the instructions above. When ready, press Start.';var K9=document.getElementById('assessmentBtn');if(K9)K9.style.display='none';N0=false;h_=0;X.fuelCount=0;X.hasStarted=false;var b9=document.getElementById('fuelBtn');var y2=document.getElementById('trialTag').textContent.trim();if(y2 === 'B'){b9.disabled=false;b9.style.opacity="1";}else {b9.disabled=true;b9.style.opacity="0.4";}X.energy=100;X.running=false;X.elapsed=0;X.speedMph=0;X.lactate=0;X.fuelPenaltyTimer=0;X.fuelAlertTimer=0;X.throughputAlert=0;u=y2 === 'B'?480:300;document.getElementById('trialTime').textContent=u;document.getElementById('engVal').textContent=100;document.getElementById('spdVal').textContent="0.0";C7.value=0;p0.textContent="Start";var P5=document.getElementById('statusVal');P5.textContent="Ready";P5.style.color="#cfe3ff";if(G){G.paused=true;G.time=0;}C4();var i_=document.getElementById('modelSelect').value;var r6=i_ === "Roman"?43:34;X.vo2Max=15.3 * ((220 - r6) / 72);u=300;document.getElementById('trialTime').textContent=300;document.getElementById('engVal').textContent=100;document.getElementById('spdVal').textContent="0.0";C7.value=0;X.speedMph=0;p0.textContent="Start";P5.textContent="Ready";P5.style.color="#cfe3ff";document.getElementById('trialMsg').textContent='Read the instructions above. When ready, press Start.';if(document.getElementById('assessmentBtn')){document.getElementById('assessmentBtn').style.display='none';}});var A=new P.Scene();A.fog=new P.Fog(0x07101b,10,45);var Y3=new P.PerspectiveCamera(55,innerWidth / innerHeight,0.1,120);Y3.position.set(6.8,3.9,8.6);var N=new P.WebGLRenderer({antialias:true,alpha:false});N.setSize(innerWidth,innerHeight);N.setPixelRatio(Math.min(devicePixelRatio,2));N.shadowMap.enabled=false;N.shadowMap.type=P.PCFSoftShadowMap;document.body.appendChild(N.domElement);window.controls=new e0(Y3,N.domElement);window.controls.target.set(0,1.35,0);controls.enableDamping=true;controls.dampingFactor=0.07;controls.maxPolarAngle=Math.PI * 0.49;controls.minDistance=0.5;controls.maxDistance=18.0;A.add(new P.AmbientLight(0x6aa0d8,1.77));var Y=new P.DirectionalLight(0xffffff,1.05);Y.position.set(7,10,5);Y.castShadow=true;Y.shadow.mapSize.set(2048,2048);Y.shadow.camera.near=0.5;Y.shadow.camera.far=40;Y.shadow.camera.left=-10;Y.shadow.camera.right=10;Y.shadow.camera.top=10;Y.shadow.camera.bottom=-10;A.add(Y);var l$=new P.DirectionalLight(0x38bdf8,0.28);l$.position.set(-9,6,-7);A.add(l$);var w9=new P.MeshStandardMaterial({color:0x0a1a2e,roughness:0.95,metalness:0.05});var E0=new P.MeshStandardMaterial({color:0x091425,roughness:0.9,metalness:0.05});var H5=new P.MeshStandardMaterial({color:0x0b1220,roughness:0.85,metalness:0.08});var f=new P.MeshStandardMaterial({color:0x7a8aa0,roughness:0.35,metalness:0.55});var R0=new P.MeshStandardMaterial({color:0x38bdf8,roughness:0.35,metalness:0.25,emissive:0x103040,emissiveIntensity:0.8});function I0(Z7 = 512,K8 = 256){var a6=document.createElement('canvas');a6.width=Z7;a6.height=K8;var H2=a6.getContext('2d');var q9=new P.CanvasTexture(a6);q9.anisotropy=8;return {c:a6,ctx:H2,tex:q9};}var f7=I0(1024,320);var S7=I0(512,256);var c0=document.createElement('canvas');c0.width=512;c0.height=512;var Z=c0.getContext('2d');{var B9=Z.createLinearGradient(0,0,512,0);B9.addColorStop(0.00,'#0a0f16');B9.addColorStop(0.35,'#0c1522');B9.addColorStop(0.65,'#0b1320');B9.addColorStop(1.00,'#09101a');Z.fillStyle=B9;Z.fillRect(0,0,512,512);Z.fillStyle='rgba(0,0,0,0.18)';Z.fillRect(252,0,8,512);var m5=0;while(m5 < 512){var P$=1 + Math.floor(Math.random() * 2);var j_=0.020 + Math.random() * 0.030;Z.fillStyle=`rgba(255,255,255,${j_})`;Z.fillRect(0,m5,512,P$);m5+=12 + Math.floor(Math.random() * 16);}for(var m2=0;m2 < 900;m2++){var M4=Math.random() * 512;var d9=Math.random() * 512;Z.fillStyle=`rgba(255,255,255,${Math.random() * 0.05})`;Z.fillRect(M4,d9,1,1);}}var E=new P.CanvasTexture(c0);E.anisotropy=8;E.wrapS=P.RepeatWrapping;E.wrapT=P.RepeatWrapping;E.repeat.set(1,8.0);E.offset.set(0,0);var W8=new P.MeshStandardMaterial({map:E,color:0x0b1018,roughness:0.98,metalness:0.00});function L4(B_,R9,Y_,P1,U6,c9){var q0=Math.min(P1,U6);if(c9 > q0 / 2)c9=q0 / 2;B_.beginPath();B_.moveTo(R9 + c9,Y_);B_.arcTo(R9 + P1,Y_,R9 + P1,Y_ + U6,c9);B_.arcTo(R9 + P1,Y_ + U6,R9,Y_ + U6,c9);B_.arcTo(R9,Y_ + U6,R9,Y_,c9);B_.arcTo(R9,Y_,R9 + P1,Y_,c9);B_.closePath();}function Z1(n$,y3){var {ctx:s5, c:P0}=n$;var F5=document.getElementById('trialTag').textContent.trim();var i4=document.getElementById('modelSelect').value.trim();var a5=parseFloat(X.speedMph.toFixed(1));s5.clearRect(0,0,P0.width,P0.height);s5.fillStyle='#061222';s5.fillRect(0,0,P0.width,P0.height);s5.strokeStyle='#38bdf8';s5.lineWidth=8;s5.strokeRect(10,10,P0.width - 20,P0.height - 20);s5.fillStyle='#e6eef7';s5.font='900 28px Inter, system-ui';s5.fillText(`SUBJECT: Average Fit Adult (${i4})`,40,60);s5.fillStyle='#38bdf8';s5.font='700 24px Inter, system-ui';s5.fillText(`CURRENT SESSION: Trial ${F5}`,40,100);if(!X.running && X.elapsed <= 0){s5.fillStyle='rgba(148,163,184,0.3)';s5.font='italic 600 22px Inter, system-ui';s5.fillText("WAITING FOR SESSION START...",40,150);}else {if(F5 === 'A'){f3(s5,P0,a5,i4);}else if(F5 === 'B'){o3(s5,P0,a5);}else {f3(s5,P0,a5,i4);}}n$.tex.needsUpdate=true;}function f3(P6,l3,I7,J8){var t3=J8 === "Roman"?6.3:6.7;var g4=I7 > t3;var V_=X.elapsed > 0 && X.elapsed < 15 && I7 > 0;var X_=X.elapsed > 0 && X.elapsed < 30 && I7 > 0;var r4=X_?0.15 * (1.0 - X.elapsed / 30):0;var b_=185,Y6=l3.width - 80,j6=50;var V1=I7 * 26.8 * 0.205 + 3.5;var D7=Math.min(V1,X.vo2Max);var S4=Math.max(0,V1 - X.vo2Max);var H4=D7 + S4;var e_=S4 / H4 + r4;var u4=1.0 - e_;P6.fillStyle='rgba(255,255,255,0.05)';P6.fillRect(40,b_,Y6,j6);P6.fillStyle='#38bdf8';P6.fillRect(40,b_,Y6 * u4,j6);if(e_ > 0.01){P6.fillStyle='rgba(255, 228, 163, 0.8)';P6.fillRect(40 + Y6 * u4,b_,Y6 * e_,j6);}if(V_){var C8=1.0 - X.elapsed / 15;var Q3=I7 / 22 * 55 * C8;P6.fillStyle='rgba(255, 154, 160, 0.9)';P6.fillRect(40,b_,Y6 * (Q3 / 100),j6);P6.fillStyle='#ff9aa0';P6.font='700 18px Inter, system-ui';P6.fillText(`● ATP-PC: ACTIVE (${Math.ceil(15 - X.elapsed)}s)`,420,150);}P6.font='700 16px Inter, system-ui';P6.fillStyle='#38bdf8';P6.fillText("● Aerobic: Active",420,100);if(g4 || X_){P6.fillStyle='#ffe4a3';P6.fillText("● Anaerobic: Active",420,125);}var D3=g4?"PRIMARY: Anaerobic Glycolysis":"PRIMARY: Aerobic Metabolism";var N8=g4?"#ffe4a3":"#38bdf8";P6.fillStyle=N8;P6.font='900 22px Inter, system-ui';P6.fillText(D3,40,140);P6.font='600 16px Inter, system-ui';P6.fillStyle='#ff9aa0';P6.fillText('■ ATP-PC',40,b_ + j6 + 35);P6.fillStyle='#38bdf8';P6.fillText('■ AEROBIC',140,b_ + j6 + 35);P6.fillStyle='#ffe4a3';P6.fillText('■ ANAEROBIC GLYCOLYSIS',280,b_ + j6 + 35);}function o3(E9,k0,t$){var t_=185,x3=k0.width - 80,z6=50;var H0=document.getElementById('modelSelect').value.trim();var N$=H0 === "Roman"?6.3:6.7;var i$=t$ * 26.8 * 0.205 + 3.5;var G9=Math.max(0,i$ - X.vo2Max);if(X.running){var z0=X.fuelPenaltyTimer > 0?1.5:1.0;if(t$ <= N$ && t$ > 0){X.lactate=Math.min(1.4,X.lactate + 0.04);if(Math.sin(performance.now() / 250) > 0.9){X.lactate=0;}}else if(t$ > N$){var N3=X.lactate > 50?1.2:1.0;var D4=G9 * 0.00225 * N3 * z0;X.lactate=Math.min(100,X.lactate + D4);}if(X.fuelPenaltyTimer > 0)X.fuelPenaltyTimer-=0.016;if(X.throughputAlert > 0)X.throughputAlert-=0.016;}if(X.throughputAlert > 0){E9.fillStyle='rgba(255, 0, 0, 0.15)';E9.fillRect(0,0,k0.width,k0.height);E9.fillStyle='#ff4d4d';E9.font='900 24px Inter';E9.textAlign='center';E9.fillText("↑ GLYCOLYTIC THROUGHPUT INCREASED",k0.width / 2,80);E9.textAlign='left';}E9.fillStyle='#ffe4a3';E9.font='900 22px Inter';E9.fillText("FORENSIC ANALYSIS: METABOLIC WASTE (LACTATE)",40,150);E9.fillStyle='rgba(255,255,255,0.05)';E9.fillRect(40,t_,x3,z6);var p7=150 + X.lactate * 1.05;var H_=228 - X.lactate * 2.2;E9.fillStyle=`rgb(${p7}, ${H_}, 163)`;E9.fillRect(40,t_,x3 * (X.lactate / 100),z6);E9.fillStyle=X.lactate > 45?'#061222':'#e6eef7';E9.font='900 20px Inter';E9.textAlign='center';var d5=t$ <= N$?X.lactate.toFixed(1):Math.round(X.lactate);E9.fillText(`${d5}%`,40 + x3 / 2,t_ + 33);E9.textAlign='left';E9.font='700 18px Inter';if(X.fuelAlertTimer > 0){E9.fillStyle=X.fuelMessage.includes("CORRECT")?"#38bdf8":"#ff9aa0";E9.fillText(`ALERT: ${X.fuelMessage}`,40,t_ + z6 + 40);X.fuelAlertTimer-=0.016;}else {if(t$ <= N$ && t$ > 0){E9.fillStyle='#38bdf8';E9.fillText("STATUS: ACTIVE CLEARANCE (STEADY STATE)",40,t_ + z6 + 40);}else if(X.lactate > 1.5){E9.fillStyle='#ffe4a3';E9.fillText("STATUS: ANAEROBIC DEBT ACCUMULATING",40,t_ + z6 + 40);}else {E9.fillStyle='#38bdf8';E9.fillText("STATUS: READY",40,t_ + z6 + 40);}}}var j3=14.0;var s0=11.0;var q6=6.6;var O4=new P.Mesh(new P.PlaneGeometry(j3,s0),w9);O4.rotation.x=-Math.PI / 2;O4.receiveShadow=true;A.add(O4);var t5=new P.Group();var a$=new P.Mesh(new P.BoxGeometry(j3,q6,0.30),E0);a$.position.set(0,q6 / 2,-(s0 / 2) + 0.15);a$.receiveShadow=true;t5.add(a$);var J4=new P.Mesh(new P.BoxGeometry(0.30,q6,s0),E0);J4.position.set(-(j3 / 2) + 0.15,q6 / 2,0);t5.add(J4);var K$=J4.clone();K$.position.x=j3 / 2 - 0.15;t5.add(K$);var n_=new P.GridHelper(j3,Math.round(j3),0x1f3b5a,0x10243a);n_.position.y=0.01;t5.add(n_);A.add(t5);var Q6=false;var C5=new P.Group();A.add(C5);function u$(P4){var G7=document.createElement('canvas');G7.width=512;G7.height=128;var c6=G7.getContext('2d');c6.clearRect(0,0,G7.width,G7.height);c6.fillStyle='rgba(15,23,42,0.72)';c6.strokeStyle='rgba(56,189,248,0.65)';c6.lineWidth=6;L4(c6,14,16,484,96,26);c6.fill();c6.stroke();c6.fillStyle='#e6eef7';c6.font='800 36px system-ui, -apple-system, Segoe UI, Roboto, Inter';c6.textBaseline='middle';c6.fillText(P4,34,64);var L_=new P.CanvasTexture(G7);L_.anisotropy=8;var O$=new P.MeshBasicMaterial({map:L_,transparent:true});var W3=new P.Mesh(new P.PlaneGeometry(3.4,0.85),O$);W3.renderOrder=10;return W3;}function c2(X3){Q6=X3;C5.traverse(H9=>{if(H9.isMesh)H9.visible=Q6;});}c2(false);function s3(d0,D1){var x7=new P.Mesh(new P.BoxGeometry(d0,0.06,D1),new P.MeshStandardMaterial({color:0x0b1a2e,roughness:0.9,metalness:0.06}));x7.receiveShadow=true;return x7;}var Q4=new P.Vector3(-4.4,0,2.1);var g8=new P.Vector3(4.4,0,2.1);var K_=new P.Vector3(0.0,0,-3.1);var T=new P.Group();T.name='strength';T.position.copy(Q4);var C2=s3(4.2,3.2);C2.position.set(0,0.03,0);T.add(C2);var Z9=new P.Mesh(new P.BoxGeometry(1.35,0.10,0.34),H5);Z9.position.set(0,0.48,0.35);Z9.castShadow=true;T.add(Z9);var G3=new P.BoxGeometry(0.06,0.45,0.06);[[-0.55,0.22,0.23],[0.55,0.22,0.23],[-0.55,0.22,0.47],[0.55,0.22,0.47]].forEach(N2=>{var V3=new P.Mesh(G3,f);V3.position.set(N2[0],N2[1],N2[2]);V3.castShadow=true;T.add(V3);});var L9=new P.BoxGeometry(0.08,1.55,0.08);var d8=new P.Mesh(L9,f);d8.position.set(-0.55,0.80,-0.55);d8.castShadow=true;var U$=d8.clone();U$.position.x=0.55;T.add(d8,U$);var z4=new P.Mesh(new P.CylinderGeometry(0.025,0.025,1.25,18),f);z4.rotation.z=Math.PI / 2;z4.position.set(0,1.45,-0.55);z4.castShadow=true;T.add(z4);{var v_=function(v4 = 1){var U_=new P.Group();var M1=new P.Mesh(U5,f);M1.rotation.z=Math.PI / 2;M1.castShadow=true;U_.add(M1);var c$=new P.Mesh(c_,b6);c$.position.x=-0.145;c$.rotation.z=Math.PI / 2;c$.castShadow=true;U_.add(c$);var J_=c$.clone();J_.position.x=0.145;U_.add(J_);U_.scale.setScalar(v4);return U_;};var I=new P.Group();var b6=new P.MeshStandardMaterial({color:0x121923,roughness:0.98,metalness:0.03});var r8=1.85,B6=0.55,V7=0.95;var A5=new P.BoxGeometry(0.06,V7,0.06);var Z4=new P.BoxGeometry(r8,0.06,0.36);var b1=[[-r8 / 2 + 0.07,V7 / 2,-B6 / 2 + 0.07],[r8 / 2 - 0.07,V7 / 2,-B6 / 2 + 0.07],[-r8 / 2 + 0.07,V7 / 2,B6 / 2 - 0.07],[r8 / 2 - 0.07,V7 / 2,B6 / 2 - 0.07]];for(var i0 of b1){var V8=new P.Mesh(A5,f);V8.position.set(i0[0],i0[1],i0[2]);V8.castShadow=true;I.add(V8);}var L3=new P.Mesh(Z4,H5);L3.position.set(0,0.68,0);L3.rotation.x=-0.14;L3.castShadow=true;L3.receiveShadow=true;I.add(L3);var S3=new P.Mesh(Z4,H5);S3.position.set(0,0.32,0);S3.rotation.x=-0.14;S3.castShadow=true;S3.receiveShadow=true;I.add(S3);var j$=new P.Mesh(new P.BoxGeometry(r8 + 0.12,0.05,B6 + 0.18),H5);j$.position.set(0,0.03,0);j$.receiveShadow=true;I.add(j$);var U5=new P.CylinderGeometry(0.022,0.022,0.24,16);var c_=new P.CylinderGeometry(0.070,0.070,0.050,6);var K7=[-0.68,-0.34,0.00,0.34,0.68];K7.forEach((w$,k4)=>{var s9=v_(0.92 + k4 * 0.02);s9.position.set(w$,0.73,-0.06);s9.rotation.y=0.08;I.add(s9);});K7.forEach((g7,m6)=>{var F9=v_(1.00 + m6 * 0.03);F9.position.set(g7,0.37,-0.06);F9.rotation.y=0.08;I.add(F9);});I.position.set(-1.15,0.0,0.45);I.rotation.y=1.60;T.add(I);}var u1=u$('Strength / Load Station');u1.position.copy(Q4).add(new P.Vector3(0,2.7,-1.6));C5.add(u1);A.add(T);var L=new P.Group();L.name='cardio';L.position.copy(g8);var U4=s3(4.2,3.2);U4.position.set(0,0.03,0);L.add(U4);var U=new P.Group();U.position.set(0,0.03,0);L.add(U);var b3=[];var N6=-0.7;var b5=0.7;var h7=0.55;var S=1.55;var e$=0.82;var x1=2.05;N6=-(S / 2) + 0.10;b5=S / 2 - 0.10;var T1=new P.Mesh(new P.BoxGeometry(e$,0.22,x1),H5);T1.position.set(0,0.16,0);T1.castShadow=true;U.add(T1);var G4=new P.Mesh(new P.BoxGeometry(h7 + 0.14,0.06,S + 0.18),new P.MeshStandardMaterial({color:0x0c1728,roughness:0.95,metalness:0.05}));G4.position.set(0,0.26,0);G4.receiveShadow=true;U.add(G4);var p5=new P.Mesh(new P.PlaneGeometry(h7,S),W8);p5.rotation.x=-Math.PI / 2;p5.position.set(0,0.295,0);p5.receiveShadow=true;U.add(p5);var R6=new P.LineSegments(new P.EdgesGeometry(new P.BoxGeometry(h7 + 0.10,0.02,S + 0.10)),new P.LineBasicMaterial({color:0x38bdf8,transparent:true,opacity:0.55}));R6.position.set(0,0.305,0);R6.renderOrder=9;U.add(R6);var n4=new P.MeshStandardMaterial({color:0x1a2738,roughness:0.95,metalness:0.02,transparent:true,opacity:0.30});var S9=12;for(var m7=0;m7 < S9;m7++){var v$=new P.Mesh(new P.BoxGeometry(h7 - 0.04,0.01,0.06),n4);v$.position.set(0,0.300,N6 + m7 * ((b5 - N6) / S9));v$.renderOrder=10;U.add(v$);b3.push(v$);}var o4=new P.CylinderGeometry(0.08,0.08,h7 + 0.08,18);var u2=new P.MeshStandardMaterial({color:0x1a2a44,roughness:0.55,metalness:0.25});var C9=new P.Mesh(o4,u2);C9.rotation.z=Math.PI / 2;C9.position.set(0,0.33,-(S / 2) - 0.04);C9.castShadow=true;U.add(C9);var x6=C9.clone();x6.position.z=S / 2 + 0.04;U.add(x6);var X4=new P.Mesh(new P.CylinderGeometry(0.035,0.035,1.05,16),f);var j0=e$ / 2 - 0.10;var o5=-(S / 2) - 0.42;var Q0=X4.clone();Q0.position.set(-j0,0.62,o5);Q0.castShadow=true;var s$=X4.clone();s$.position.set(j0,0.62,o5);s$.castShadow=true;U.add(Q0,s$);var t0=new P.Mesh(new P.CylinderGeometry(0.032,0.032,e$ - 0.10,16),f);t0.rotation.z=Math.PI / 2;t0.position.set(0,1.15,o5);t0.castShadow=true;U.add(t0);var s8=new P.Mesh(new P.CylinderGeometry(0.028,0.028,S + 0.35,16),f);s8.rotation.x=Math.PI / 2;s8.position.set(-j0,0.95,-0.02);s8.castShadow=true;U.add(s8);var E2=s8.clone();E2.position.x=j0;U.add(E2);var n7=new P.Mesh(new P.BoxGeometry(0.58,0.40,0.22),new P.MeshStandardMaterial({color:0x111b2e,roughness:0.55,metalness:0.12}));n7.position.set(0,1.02,o5 + 0.14);n7.castShadow=true;U.add(n7);var S1=new P.Mesh(new P.PlaneGeometry(0.56,0.30),new P.MeshBasicMaterial({map:S7.tex,side:P.DoubleSide,transparent:true,depthTest:true,depthWrite:false,toneMapped:false,polygonOffset:true,polygonOffsetFactor:-1,polygonOffsetUnits:-1}));n7.add(S1);S1.position.set(0,0.02,0.162);S1.rotation.set(-0.10,0,0);var K6=new P.Mesh(new P.BoxGeometry(2.6,0.88,0.08),new P.MeshStandardMaterial({color:0x111b2e,roughness:0.6,metalness:0.15}));K6.position.set(0,2.55,-1.55);L.add(K6);var g2=new P.Mesh(new P.PlaneGeometry(2.46,0.78),new P.MeshBasicMaterial({map:f7.tex,transparent:true,depthTest:false,depthWrite:false,toneMapped:false}));g2.position.set(0,2.55,-1.495);g2.renderOrder=1000;L.add(g2);var C_=new P.Mesh(new P.PlaneGeometry(2.6,0.92),new P.MeshBasicMaterial({color:0x38bdf8,transparent:true,opacity:0.10,depthWrite:false,depthTest:false}));C_.position.set(0,2.55,-1.505);C_.renderOrder=900;L.add(C_);var l4=u$('Cardio Bay');l4.position.copy(g8).add(new P.Vector3(0,4.1,-1.6));C5.add(l4);A.add(L);var C=new P.Group();C.name='forensics';C.position.copy(K_);var f9=s3(4.8,3.6);f9.position.set(0,0.03,0);C.add(f9);var U2=new P.LineBasicMaterial({color:0x38bdf8,transparent:true,opacity:0.55});var T9=[new P.Vector3(-1.2,0.06,-1.0),new P.Vector3(1.2,0.06,-1.0),new P.Vector3(1.2,0.06,1.0),new P.Vector3(-1.2,0.06,1.0),new P.Vector3(-1.2,0.06,-1.0)];C.add(new P.Line(new P.BufferGeometry().setFromPoints(T9),U2));function K2(q3,a0){var j5=new P.Group();var N5=new P.Mesh(new P.CylinderGeometry(0.04,0.05,1.05,10),f);N5.position.y=0.52;N5.castShadow=true;j5.add(N5);var z$=new P.Mesh(new P.BoxGeometry(0.20,0.12,0.20),H5);z$.position.y=1.05;z$.castShadow=true;j5.add(z$);var w8=new P.CylinderGeometry(0.02,0.02,0.80,8);for(var x8=0;x8 < 3;x8++){var e7=new P.Mesh(w8,f);var Y9=x8 * (Math.PI * 2 / 3);e7.position.set(Math.cos(Y9) * 0.18,0.30,Math.sin(Y9) * 0.18);e7.rotation.z=0.55;e7.rotation.y=Y9;j5.add(e7);}j5.position.set(q3,0,a0);return j5;}C.add(K2(-1.55,-1.35),K2(1.55,-1.35),K2(0,1.55));var k_=new P.Mesh(new P.BoxGeometry(1.55,0.95,0.08),new P.MeshStandardMaterial({color:0x111b2e,roughness:0.6,metalness:0.15}));var o2=k_.clone();o2.position.set(-1.05,2.35,-1.70);C.add(o2);var J7=k_.clone();J7.position.set(1.05,2.35,-1.70);C.add(J7);var m$=u$('Movement Analysis Booth');m$.position.copy(K_).add(new P.Vector3(0,2.7,-1.6));C5.add(m$);A.add(C);function z1(){var v1=new P.Group();v1.userData.__isMannequin=true;var F_=new P.MeshStandardMaterial({color:0xdbe7f7,roughness:0.65,metalness:0.08});var w4=new P.Mesh(new P.CapsuleGeometry(0.20,0.14,6,14),F_);w4.position.set(0,0.95,0);w4.castShadow=true;var y_=new P.Mesh(new P.CapsuleGeometry(0.26,0.55,8,18),F_);y_.position.set(0,1.55,0);y_.castShadow=true;var y9=new P.Mesh(new P.SphereGeometry(0.17,18,18),F_);y9.position.set(0,2.15,0);y9.castShadow=true;var t9=(B4,u8)=>{var d3=new P.Mesh(new P.CapsuleGeometry(B4,u8,6,12),F_);d3.castShadow=true;return d3;};var h2=t9(0.06,0.45);h2.position.set(-0.38,1.65,0);h2.rotation.z=0.45;var f1=t9(0.06,0.45);f1.position.set(0.38,1.65,0);f1.rotation.z=-0.45;var D9=t9(0.07,0.60);D9.position.set(-0.14,0.55,0);var Z_=t9(0.07,0.60);Z_.position.set(0.14,0.55,0);v1.add(w4,y_,y9,h2,f1,D9,Z_);return v1;}async function B8(h0,j8){var I1=B$(h0);M5=I1.id;if(K){A.remove(K);K=null;}if(!I1 || !I1.url){K=z1();A.add(K);return K;}return await new Promise((N_,t2)=>{var n3=new k9();n3.load(I1.url,k3=>{K=k3.scene || k3.scenes && k3.scenes[0] || null;if(!K)return t2(new Error("GLB loaded but scene is empty"));K.traverse(k$=>{if(k$.isMesh){k$.castShadow=true;k$.receiveShadow=true;}});A.add(K);Y1=null;G=null;var W5=k3.animations || [];if(W5.length){Y1=new P.AnimationMixer(K);var r3=W5.find(M3=>(/run|jog/i).test(M3.name)) || W5.find(E3=>(/walk/i).test(E3.name)) || W5[0];G=Y1.clipAction(r3);G.play();G.paused=true;}K.updateWorldMatrix(true,true);var b8=[];var u_=new P.Vector3();var x$=0;K.traverse(R1=>{if(!(R1.isMesh || R1.isSkinnedMesh) || !R1.geometry)return;if(!R1.geometry.boundingBox)R1.geometry.computeBoundingBox();var U9=new P.Box3().copy(R1.geometry.boundingBox).applyMatrix4(R1.matrixWorld);var J1=new P.Vector3();U9.getCenter(J1);b8.push({b:U9,center:J1});u_.add(J1);x$++;});if(x$){u_.multiplyScalar(1 / x$);var O5=new P.Box3();for(var j4 of b8){if(j4.center.distanceTo(u_) < 5.0)O5.union(j4.b);}var h$=new P.Vector3();O5.getSize(h$);if(h$.y > 1e-6){var w_=1.75;var Q7=w_ / h$.y;K.scale.setScalar(Q7);K.updateWorldMatrix(true,true);}}N_(K);},G2=>{if(!j8)return;var I6=G2 && G2.loaded?G2.loaded:0;var d4=G2 && G2.total?G2.total:0;var x_=d4 >= I6?d4:I6;j8(x_?Math.round(I6 / x_ * 100):null);},x0=>t2(x0));});}var p2=new P.Vector3(6.8,3.9,8.6);var X1=new P.Vector3(0,1.35,0);function v8(){Y3.position.copy(p2);controls.target.copy(X1);controls.update();}function y5(N4){if(!K)return;var k8=K4 && K4.zone?K4.zone:N4;var h5=0;if(k8 === 'strength'){K.position.copy(Q4).add(new P.Vector3(0,0.06,-0.10));h5=0;}else if(k8 === 'cardio'){K.position.copy(g8).add(new P.Vector3(0,0.30,0.05));h5=Math.PI;}else if(k8 === 'forensics' || k8 === 'analysis'){K.position.copy(K_).add(new P.Vector3(0,0.06,0.00));h5=0;}K.rotation.set(0,h5,0);}function s7(C0){T.visible=true;L.visible=true;C.visible=true;if(C0 === 'strength'){X1.set(Q4.x,1.25,Q4.z);p2.set(Q4.x + 3.2,2.6,Q4.z + 4.8);}else if(C0 === 'cardio'){X1.set(g8.x,1.10,g8.z);p2.set(g8.x,1.8,g8.z + 2.4);}else if(C0 === 'forensics'){X1.set(K_.x,1.25,K_.z);p2.set(K_.x + 3.6,2.6,K_.z + 5.1);}y5(C0);}function a7(i5,p3){X.running=false;X.hasStarted=false;if(G)G.paused=true;C4();document.getElementById('trialTag').textContent=p3;u=p3 === 'B'?480:300;document.getElementById('trialTime').textContent=u;var A6=document.getElementById('fuelBtn');var A3=p3 === 'B';A6.disabled=!A3;A6.style.opacity=A3?"1":"0.4";X.lactate=0;X.fuelCount=0;X.energy=100;N0=false;document.getElementById('engVal').textContent="100";document.getElementById('trialMsg').innerHTML=`<b>Trial ${p3} Loaded.</b> Press Start to begin forensic validation.`;document.getElementById('startBtn').textContent="Start";}async function t1(){s7('cardio');window.currentTrials={mcqs:[]};var d6=document.getElementById('trialA');var d$=document.getElementById('trialB');if(d6)d6.onclick=()=>a7(window.currentTrials,'A');if(d$)d$.onclick=()=>a7(window.currentTrials,'B');document.getElementById('trialTag').textContent="-";document.getElementById('trialTime').textContent="0";document.getElementById('trialMsg').innerHTML="<b>Module Loaded.</b> Select Trial A or B to begin.";}function B5(u9){var u0=T2(u9);K4=u0;document.getElementById('moduleTitle').textContent=u0.label;s7(u0.zone || 'all');var f8=document.getElementById('badge');f8.style.display="block";f8.style.top="14px";if(typeof u0.onEnter === 'function'){u0.onEnter();}}var S_=[...document.querySelectorAll('.pill')];function A2(q8){S_.forEach(f$=>f$.classList.toggle('active',f$ === q8 && q8.dataset.zone !== 'labels'));}S_.forEach(q$=>{q$.addEventListener('click',()=>{var i6=q$.dataset.zone;if(i6 === 'labels'){c2(!Q6);q$.classList.toggle('active',Q6);return;}s7(i6);A2(q$);});});function V0(){u3.textContent=X.speedMph.toFixed(1);o8.textContent=Math.round(X.energy);if(X.energy <= 0){j.textContent="CRITICAL FAILURE: EXHAUSTED";j.style.color="#ff9aa0";}else if(X.running){j.textContent="Simulation Active";j.style.color="#38bdf8";}else {j.textContent="Ready";j.style.color="#cfe3ff";}}var A_=new P.Clock();var P_=A_.getElapsedTime();var C4=()=>{var p$=Q._run;if(p$ && p$.rig){for(var [t4,a8] of p$.rig.base)t4.quaternion.copy(a8);}};function Q(){requestAnimationFrame(Q);var P8=A_.getElapsedTime();var G8=P8 - P_;P_=P8;controls.update();if(!Q._blink)Q._blink={model:null,targets:[],state:0,t:0,next:0};var q5=Q._blink;if(K && q5.model !== K){q5.model=K;q5.targets=[];q5.state=0;q5.t=0;q5.next=performance.now() / 1000 + 1.5;var e5=(V5,u7)=>{var g0=V5.morphTargetDictionary;if(!g0 || g0[u7] == null)return false;q5.targets.push({mesh:V5,idx:g0[u7]});return true;};var z3=false;var z9=false;K.traverse(n6=>{if(!n6.isMesh || !n6.morphTargetInfluences || !n6.morphTargetDictionary)return;z3=e5(n6,"Eye_Blink") || z3;z3=e5(n6,"Eye_Blink_L") || z3;z3=e5(n6,"Eye_Blink_R") || z3;z9=e5(n6,"Expressions_eyeClosedL_max") || z9;z9=e5(n6,"Expressions_eyeClosedR_max") || z9;});var r5=q5.targets.some(i3=>{var r_=i3.mesh.morphTargetDictionary;return r_ && (r_["Eye_Blink"] != null || r_["Eye_Blink_L"] != null || r_["Eye_Blink_R"] != null);});if(r5){q5.targets=q5.targets.filter(p1=>{var I2=p1.mesh.morphTargetDictionary;return I2 && (I2["Eye_Blink"] != null || I2["Eye_Blink_L"] != null || I2["Eye_Blink_R"] != null);});}else {q5.targets=q5.targets.filter(k6=>{var F7=k6.mesh.morphTargetDictionary;return F7 && (F7["Expressions_eyeClosedL_max"] != null || F7["Expressions_eyeClosedR_max"] != null);});}}if(q5.targets.length){var e6=performance.now() / 1000;if(q5.state === 0 && e6 >= q5.next){q5.state=1;q5.t=0;q5.next=e6 + 4.2 + Math.random() * 1.6;}var C$=0.06;var C1=0.02;var X8=0.10;var a1=v6=>{for(var O6 of q5.targets){O6.mesh.morphTargetInfluences[O6.idx]=v6;}};if(q5.state !== 0){q5.t+=G8;if(q5.state === 1){var s_=Math.min(1,q5.t / C$);a1(s_);if(q5.t >= C$){q5.state=2;q5.t=0;}}else if(q5.state === 2){a1(1);if(q5.t >= C1){q5.state=3;q5.t=0;}}else if(q5.state === 3){var X7=1 - Math.min(1,q5.t / X8);a1(X7);if(q5.t >= X8){q5.state=0;q5.t=0;a1(0);}}}}if(!Q._run){Q._run={rig:null,phase:0,wasRunning:false,tmpQ:new P.Quaternion(),tmpE:new P.Euler()};Q._getSkeleton=q7=>{var I_=null;q7.traverse(B7=>{if(I_)return;if(B7.isSkinnedMesh && B7.skeleton)I_=B7.skeleton;});return I_;};Q._initRig=()=>{if(!K)return null;var r0=Q._getSkeleton(K);if(!r0)return null;var I8=h1=>{for(var W6 of h1){var Y$=r0.getBoneByName(W6);if(Y$)return Y$;}return null;};var o7={spine01:I8(['spine01','Spine1','mixamorigSpine1','spine']),spine02:I8(['spine02','Spine2','mixamorigSpine2']),neck:I8(['neck','Neck','mixamorigNeck']),head:I8(['head','Head','mixamorigHead']),thighL:I8(['thigh_L','thigh.L','LeftUpLeg','mixamorigLeftUpLeg']),thighR:I8(['thigh_R','thigh.R','RightUpLeg','mixamorigRightUpLeg']),calfL:I8(['calf_L','shin_L','calf.L','LeftLeg','mixamorigLeftLeg']),calfR:I8(['calf_R','shin_R','calf.R','RightLeg','mixamorigRightLeg']),upArmL:I8(['upperarm_L','upper_arm_L','upperarm.L','LeftArm','mixamorigLeftArm']),upArmR:I8(['upperarm_R','upper_arm_R','upperarm.R','RightArm','mixamorigRightArm']),loArmL:I8(['lowerarm_L','forearm_L','lowerarm.L','LeftForeArm','mixamorigLeftForeArm']),loArmR:I8(['lowerarm_R','forearm_R','lowerarm.R','RightForeArm','mixamorigRightForeArm']),footL:I8(['foot_L','foot.L','LeftFoot','mixamorigLeftFoot']),footR:I8(['foot_R','foot.R','RightFoot','mixamorigRightFoot']),toesL:I8(['toes_L','toe_L','toes.L','LeftToeBase','mixamorigLeftToeBase']),toesR:I8(['toes_R','toe_R','toes.R','RightToeBase','mixamorigRightToeBase'])};var X5=new Map();Object.values(o7).forEach(D_=>{if(D_)X5.set(D_,D_.quaternion.clone());});var d2=P.MathUtils.degToRad(q4.upperarmFlex || 0);if(d2){var S$=new P.Quaternion().setFromEuler(new P.Euler(d2,0,0));if(o7.upArmL){var G6=X5.get(o7.upArmL);if(G6){var a2=G6.clone().multiply(S$);X5.set(o7.upArmL,a2);o7.upArmL.quaternion.copy(a2);}}if(o7.upArmR){var T_=X5.get(o7.upArmR);if(T_){var M9=T_.clone().multiply(S$);X5.set(o7.upArmR,M9);o7.upArmR.quaternion.copy(M9);}}}if(o7.spine01){var O0=P.MathUtils.degToRad(q4.spine01Flex || 0);var I4=new P.Quaternion().setFromEuler(new P.Euler(O0,0,0));var W0=X5.get(o7.spine01);if(W0){var H7=W0.clone().multiply(I4);X5.set(o7.spine01,H7);o7.spine01.quaternion.copy(H7);}}var F2=[...X5.keys()].length;if(F2 < 4)return null;var T0=P.MathUtils.degToRad(q4.shTuck);var g6=P.MathUtils.degToRad(q4.shER);var R4=P.MathUtils.degToRad(q4.hipAdd);var T7=new P.Euler();var Y7=new P.Quaternion();var N1=(e3,x2,X2,D$)=>{if(!e3)return;var C3=X5.get(e3);if(!C3)return;T7.set(x2,X2,D$);Y7.setFromEuler(T7);C3.multiply(Y7);e3.quaternion.copy(C3);};N1(o7.upArmL,0,+g6,-T0);N1(o7.upArmR,0,-g6,+T0);N1(o7.thighL,0,0,-R4);N1(o7.thighR,0,0,+R4);return {bones:o7,base:X5};};}var B2=Q._run;if(!B2.rig && K && !K.userData.__isMannequin){B2.rig=Q._initRig();}var o1=(Q9,J0,h6,s4)=>{if(!B2.rig || !Q9)return;var J2=B2.rig.base.get(Q9);if(!J2)return;B2.tmpE.set(J0,h6,s4);B2.tmpQ.setFromEuler(B2.tmpE);Q9.quaternion.copy(J2).multiply(B2.tmpQ);};var l0=!!(X.running && X.energy > 0 && L.visible);if(l0){var W4=X.speedMph;var N9=E5(W4 / 6.0,0,2.0);var p8=E5(N9,0,1.35);var J5=1.6 * N9 + 0.15;B2.phase+=G8 * (Math.PI * 2) * J5;var E_=Math.sin(B2.phase);var v5=Math.sin(B2.phase * 2.0);var H6=P.MathUtils.degToRad(28) * p8;var L7=P.MathUtils.degToRad(90) * p8;var K3=P.MathUtils.degToRad(22) * p8;var z_=P.MathUtils.degToRad(4) * (p8 * 0.6);var G5=B2.rig.bones;if(M5 === "Roma"){var r7=P.MathUtils.degToRad(5);o1(G5.thighL,H6 * E_,0,-r7);o1(G5.thighR,-H6 * E_,0,+r7);}else {o1(G5.thighL,H6 * E_,0,0);o1(G5.thighR,-H6 * E_,0,0);}var t6=Math.max(0,-E_) * L7;var O9=Math.max(0,E_) * L7;o1(G5.calfL,-t6,0,0);o1(G5.calfR,-O9,0,0);var x9=Math.max(0,-E_);var Z3=Math.max(0,E_);var D8=Math.max(0,E_);var i2=Math.max(0,-E_);var n0=P.MathUtils.degToRad(12) * p8;var l6=P.MathUtils.degToRad(18) * p8;var O1=P.MathUtils.degToRad(15) * p8;var m1=+n0 * x9 + -l6 * D8;var I3=+n0 * Z3 + -l6 * i2;o1(G5.footL,m1,0,0);o1(G5.footR,I3,0,0);o1(G5.toesL,O1 * D8,0,0);o1(G5.toesR,O1 * i2,0,0);var m3=P.MathUtils.degToRad(17);var R$=P.MathUtils.degToRad(10);var m9=P.MathUtils.degToRad(7);var R2=P.MathUtils.degToRad(90);o1(G5.upArmL,-K3 * E_ - R$,+m9,-m3);o1(G5.upArmR,K3 * E_ - R$,-m9,+m3);o1(G5.loArmL,R2,0,0);o1(G5.loArmR,R2,0,0);var H3=P.MathUtils.degToRad(9) * p8 * -E_;var h8=P.MathUtils.degToRad(1.5) * p8 * E_;if(G5.spine01 && G5.spine02 && G5.spine03){o1(G5.spine01,0,H3 * 0.45,h8 * 0.45);o1(G5.spine02,0,H3 * 0.35,h8 * 0.35);o1(G5.spine03,0,H3 * 0.20,h8 * 0.20);}else if(G5.spine01 && G5.spine02){o1(G5.spine01,0,H3 * 0.60,h8 * 0.60);o1(G5.spine02,0,H3 * 0.40,h8 * 0.40);}else if(G5.spine01){o1(G5.spine01,0,H3,h8);}else if(G5.spine02){o1(G5.spine02,0,H3,h8);}else if(G5.spine03){o1(G5.spine03,0,H3,h8);}if(G5.neck)o1(G5.neck,0,H3 * 0.35,0);if(G5.head)o1(G5.head,0,H3 * 0.15,0);if(G)G.paused=false;}else {C4();if(G)G.paused=true;}if(X.running){var V9=0.35 + X.speedMph / 12 * 2.0;for(var l_ of b3){l_.position.z+=G8 * V9;if(l_.position.z > b5)l_.position.z=N6;}var R3=0.10 + X.speedMph / 12 * 1.10;E.offset.y=(E.offset.y + G8 * R3) % 1;}if(Q6){for(var j9 of C5.children)j9.lookAt(Y3.position);}function b$(D6){var {ctx:e2, c:Q2}=D6;e2.clearRect(0,0,Q2.width,Q2.height);e2.fillStyle='rgba(6,18,34,1)';e2.fillRect(0,0,Q2.width,Q2.height);e2.strokeStyle='rgba(56,189,248,0.85)';e2.lineWidth=10;e2.strokeRect(10,10,Q2.width - 20,Q2.height - 20);e2.fillStyle='#e6eef7';e2.textAlign='center';e2.textBaseline='middle';e2.font='900 64px system-ui, -apple-system, Segoe UI, Roboto, Inter';e2.fillText(`${X.speedMph.toFixed(1)} mph`,Q2.width / 2,Q2.height / 2);D6.tex.needsUpdate=true;}Z1(f7,'CARDIO BOARD');b$(S7);if(X.running && X.energy > 0){X.elapsed+=G8;var r1=parseFloat(X.speedMph.toFixed(1));var e1=r1 * 26.8 * 0.205 + 3.5;var o$=document.getElementById('modelSelect').value;var h3=o$ === "Roman"?6.3:6.7;var F8={Roma:{lowLactateMulti:1.01,highLactateMulti:1.11,recoveryRate:0.07,tankSize:1200,penaltySeverity:1.9},Roman:{lowLactateMulti:1.07,highLactateMulti:1.22,recoveryRate:0.05,tankSize:1200,penaltySeverity:2.3},Default:{lowLactateMulti:1.2,highLactateMulti:1.2,recoveryRate:0.05,tankSize:1200,penaltySeverity:1.5}};var g1=F8[o$] || F8.Default;var S8=X.lactate > 50?g1.highLactateMulti:0.85;if(e1 > X.vo2Max){var m0=e1 - X.vo2Max;var d_=m0 / 60 / g1.tankSize * 12000;X.energy-=d_ * S8 * G8;}else {X.energy=Math.min(100,X.energy + g1.recoveryRate * G8);}var Y0=X.fuelPenaltyTimer > 0?g1.penaltySeverity:1.0;if(r1 > h3){var A1=e1 - X.vo2Max;X.lactate=Math.min(100,X.lactate + A1 * 0.0055 * Y0 * G8);}else if(r1 > 0){X.lactate=Math.max(0,X.lactate - 0.8 * G8);}if(X.fuelPenaltyTimer > 0)X.fuelPenaltyTimer-=G8;if(X.fuelAlertTimer > 0)X.fuelAlertTimer-=G8;if(X.throughputAlert > 0)X.throughputAlert-=G8;if(K4?.id === 'FL-001'){u=Math.max(0,u - G8);document.getElementById('trialTime').textContent=Math.ceil(u);}}if(X.energy <= 0 || u <= 0 || X.lactate >= 100){var O3=document.getElementById('modelSelect').value;var y8=document.getElementById('trialTag').textContent.trim();var A9=document.getElementById('statusVal');var h4=document.getElementById('trialMsg');if(N0){A9.textContent="INTEGRITY BREACH";A9.style.color="#ff9aa0";h4.innerHTML=`<b style="color:#ff9aa0;">Trial Failed:</b> Speed was altered during session. Reset required.`;}else if(y8 === 'A'){if(u <= 0){var m8=O3 === "Roma"?6.7:6.3;if(h_ === m8 && X.energy >= 60){p_("Trial A Complete: Aerobic Dominance Confirmed.");}else {var J6=h_ !== m8?"Incorrect starting speed.":"Insufficient energy reserve.";h4.innerHTML=`<b style="color:#ff9aa0;">Trial Failed:</b> ${J6}`;}}}else if(y8 === 'B'){if(X.lactate >= 100){A9.textContent="CRITICAL FAILURE: ACIDOSIS";A9.style.color="#ff9aa0";h4.innerHTML=`<b style="color:#ff9aa0;">Trial Failed:</b> Waste accumulation exceeded clearance capacity.`;}else if(X.energy <= 0){A9.textContent="FAILURE: EXHAUSTION";A9.style.color="#ff9aa0";h4.innerHTML=`<b style="color:#ff9aa0;">Trial Failed:</b> W' Balance depleted.`;}else if(u <= 0){if(X.fuelCount === 1){p_("Trial B Complete: Metabolic Waste Managed.");}else {h4.innerHTML=`<b style="color:#ff9aa0;">Trial Failed:</b> Required fuel event (1) was not recorded.`;}}}else if(y8 === 'C'){}X.running=false;X.hasStarted=false;if(G)G.paused=true;C4();document.getElementById('startBtn').textContent="Start";}V0();N.render(A,Y3);}function p_(D2){X.running=false;if(G)G.paused=true;if(window.controls)window.controls.enabled=true;var z7=document.getElementById('trialTag').textContent.trim();var H8=document.getElementById('trialMsg');if(z7 === 'A'){H8.innerHTML=`<b style="color:#38bdf8;">Goal Reached:</b> Trial A validated. Unlocking Trial B...`;setTimeout(()=>{X.hasStarted=false;X.fuelCount=0;X.lactate=0;N0=false;a7(window.currentTrials,'B');H8.innerHTML=`<b>Trial B Loaded.</b> Survive 480s and record 1 fueling event.`;},3000);}else if(z7 === 'B'){H8.innerHTML=`<b style="color:#38bdf8;">Forensic Validation Successful.</b> All trials complete.`;var T8=document.getElementById('assessmentBtn');if(T8){T8.style.display='block';var n1=document.getElementById('moduleSelect').value || "FL-001";T8.onclick=()=>{window.location.href=`../mcq/?module=${n1}&mode=review`;};}}}Q();n8.addEventListener('click',async ()=>{var i8=document.getElementById('modelSelect').value;var H1=document.getElementById('moduleSelect').value;var j7=i8 === "Roman"?43:34;var F0=220 - j7;X.vo2Max=15.3 * (F0 / 72);J3(i8);n8.disabled=true;n8.textContent="Loading...";try{await B8(i8,X9=>{n8.textContent=`Loading ${X9}%`;});document.getElementById('gate').style.display="none";var X0=document.getElementById('ui');var p4=document.getElementById('badge');if(X0)X0.style.display="flex";if(p4){p4.style.display="block";p4.style.top="14px";}if(H1 === 'FL-001')s7('cardio');B5(H1);v8();var M7=localStorage.getItem(`${H1}_Status`);var s1=document.getElementById('reviewBtn');if(M7 === 'completed'){var Z8=document.getElementById('moduleTitle');if(!Z8.innerHTML.includes('✓')){Z8.innerHTML+=" <span style='color:#4ade80; margin-left:8px;'>[✓ Completed]</span>";}if(s1){s1.style.display='block';s1.onclick=()=>{var o_=document.getElementById('moduleSelect')?.value || "FL-001";var l2=`../mcq/?module=${o_}`;window.open(l2,'_blank');};}}else {if(s1)s1.style.display='none';}}catch(w0){console.error("Entry Error:",w0);n8.textContent="Error - Check Console";}finally{n8.disabled=false;}});addEventListener('resize',()=>{Y3.aspect=innerWidth / innerHeight;Y3.updateProjectionMatrix();N.setSize(innerWidth,innerHeight);N.setPixelRatio(Math.min(devicePixelRatio,2));});</script>
<div id="instrOverlay" style="position:fixed; inset:0; z-index:9999; display:none; align-items:center; justify-content:center; background:rgba(7,16,27,0.96); backdrop-filter:blur(10px); font-family:system-ui,-apple-system,sans-serif;">
    <div style="width:min(760px, 95vw); max-height:85vh; background:#0f172a; border:1px solid rgba(56,189,248,0.4); border-radius:24px; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 30px 60px rgba(0,0,0,0.6);">
        
        <div style="display:flex; background:rgba(30,41,59,0.5); border-bottom:1px solid rgba(148,163,184,0.15);">
            <div id="t-concept" style="flex:1; padding:18px; text-align:center; cursor:pointer; font-size:11px; font-weight:900; color:#38bdf8; text-transform:uppercase; letter-spacing:1px; background:rgba(56,189,248,0.1); box-shadow:inset 0 -3px 0 #38bdf8;" onclick="switchMetabolicTab(&#x27;concept&#x27;);">Concept</div>
            <div id="t-guide" style="flex:1; padding:18px; text-align:center; cursor:pointer; font-size:11px; font-weight:900; color:#a8c0da; text-transform:uppercase; letter-spacing:1px;" onclick="switchMetabolicTab(&#x27;guide&#x27;);">Trial Guide</div>
            <div id="t-instr" style="flex:1; padding:18px; text-align:center; cursor:pointer; font-size:11px; font-weight:900; color:#a8c0da; text-transform:uppercase; letter-spacing:1px;" onclick="switchMetabolicTab(&#x27;instr&#x27;);">Module Instructions</div>
        </div>

        <div id="metabolicContent" style="padding:32px; overflow-y:auto; color:#cfe3ff; font-size:14px; line-height:1.6;">
            
            <div id="p-concept" style="display:block;">
                <h4 style="margin:0 0 14px 0; color:#38bdf8; text-transform:uppercase; font-size:15px;">Concept (read first)</h4>
                <p><b>Lesson Focus:</b><br>
                Running speed determines which energy system contributes the most energy. As speed increases, the primary energy contribution shifts from Aerobic Metabolism to Anaerobic Glycolysis, and at very high speeds to ATP-PC (PCr).</p>
                
                

                <p>Multiple energy systems can contribute simultaneously. ‘Primary’ refers to the largest contributor. Some systems, like ATP-PC, are only active while their immediate stores are available.</p>
                <ul style="padding-left:18px;">
                    <li><b>Aerobic Contribution:</b> Uses oxygen to meet energy demand. When this system is primary, energy levels remain stable.</li>
                    <li><b>Oxygen Deficit:</b> When running speed exceeds aerobic capacity, oxygen supply cannot fully meet demand.</li>
                    <li><b>Anaerobic Supplement:</b> Any shortfall is covered by anaerobic systems drawing from a finite reserve (W′ Balance), causing energy to decline.</li>
                </ul>

                <h4 style="margin:20px 0 14px 0; color:#38bdf8; text-transform:uppercase; font-size:15px;">Trial B — Concept (read first)</h4>
                <p><b>Carbohydrate energy/fuel:</b> isn’t instant; the body needs time to use it. During high-intensity, anaerobic-dominant exercise, glucose is broken down by glycolysis to make ATP, and if oxygen can’t keep up, pyruvate is converted to lactate—so early fueling can increase lactate without improving performance. Proper timing helps sustain effort and manage fatigue.</p>
                <p><b>Fuel Timing Optimization:</b> Fuel must be taken before fatigue becomes excessive, because once metabolic by-products accumulate, the body cannot efficiently restore usable energy. Waiting too long limits the performance benefit of fuel and increases the risk of rapid decline.</p>
                <p><b>Crash Condition:</b> Lactate reaching 100% ends the trial immediately, even if time remains or energy is sufficient.</p>
                <p><b>Learning Goals:</b></p>
                <ul style="padding-left:18px;">
                    <li>Observe how energy drains under anaerobic conditions.</li>
                    <li>Understand how fuel timing can maintain W′ energy without causing lactate to reach the crash threshold.</li>
                    <li>Recognize the trade-off between energy restoration and lactate accumulation.</li>
                </ul>
            </div>

            <div id="p-guide" style="display:none;">
                <h4 style="margin:0 0 14px 0; color:#38bdf8; text-transform:uppercase; font-size:15px;">Trial Guide Overview</h4>
                <p><b>VO₂ Max (Aerobic Capacity):</b> In this lab, this represents the subject’s modeled oxygen budget—the maximum sustainable oxygen supply available to support running.</p>
                <p><b>The Total VO₂ Cost:</b> When running, total oxygen demand is modeled as the sum of:<br>
                - <b>Resting Metabolic Rate (3.5 ml/kg/min):</b> Baseline oxygen cost required to sustain basic physiological function (≈1 MET).<br>
                - <b>Work VO₂:</b> The additional oxygen required to perform the mechanical work of running.<br>
                - <b>Oxygen Deficit:</b> If Total VO₂ Cost > VO₂ Max, energy demand exceeds aerobic supply and energy is supplemented by the finite W′ Balance.</p>

                <div style="margin:20px 0; display:grid; gap:15px;">
                    <div style="background:rgba(255,154,160,0.1); padding:15px; border-radius:12px; border:1px solid rgba(255,154,160,0.2);">
                        <b style="color:#ff9aa0;">1. ATP-PC (Phosphagen)</b><br>
                        Speed: Instant | Duration: ~0–10 seconds | Capacity: Very small “burst tank”<br>
                        Explanation: Work:Rest ratio is usually 1:12 to 1:20. For every 1s of maximal effort, 12–20s of rest are required. For a 10s sprint: Min rest 120s; Max rest 200s.
                    </div>
                    <div style="background:rgba(255,228,163,0.1); padding:15px; border-radius:12px; border:1px solid rgba(255,228,163,0.2);">
                        <b style="color:#ffe4a3;">2. Anaerobic Glycolysis (W′)</b><br>
                        Speed: Fast, short-term | Capacity: Small, finite “reserve tank” | Work:Rest: 1:3–1:5<br>
                        Use: Supplies additional energy when aerobic oxygen delivery is insufficient.
                    </div>
                    <div style="background:rgba(56,189,248,0.1); padding:15px; border-radius:12px; border:1px solid rgba(56,189,248,0.2);">
                        <b style="color:#38bdf8;">3. Aerobic (VO₂ Max)</b><br>
                        Speed: Moderate, sustainable | Capacity: Large “main tank” | Work:Rest: 1:1–1:3<br>
                        Use: Supplies most energy at low-to-moderate speeds.
                    </div>
                </div>

                <h4 style="margin:0 0 10px 0; color:#38bdf8; text-transform:uppercase; font-size:13px;">Trial B — Overview</h4>
                <p>In Trial B, the subject is operating entirely above their aerobic ceiling (Roma - 6.8 mph), so anaerobic glycolysis is the primary energy system. The trial introduces the Lactate Proxy to visualize metabolic waste and demonstrates how fueling affects energy and lactate accumulation.</p>
                <ul style="padding-left:18px;">
                    <li>In Trial A, oxygen delivery matched demand, so lactate was negligible.</li>
                    <li>In Trial B, the system is stressed: oxygen supply is insufficient, and lactate begins to accumulate.</li>
                </ul>
            </div>

            <div id="p-instr" style="display:none;">
                <h4 style="margin:0 0 14px 0; color:#38bdf8; text-transform:uppercase; font-size:15px;">Trial A — Aerobic Metabolism</h4>
                <p><b>Goal:</b> Find the highest speed at which the subject completes a 300 s trial without crossing into Anaerobic Dominance (remaining at or above 60% energy).</p>
                <p><b>The 60% Threshold (Lab-Defined):</b> In real physiology, the transition to anaerobic dominance occurs at an individual-specific threshold (commonly 50–90% of VO₂ max). In this lab, 60% is used as a standardized simulation threshold and is not a universal biological constant.</p>
                
                <p><b>1. Calculate the "Oxygen Budget" (VO₂ Max)</b><br>
                Formula: VO₂max ≈ 15.3 × (HRmax / HRrest)<br>
                Model Info: Roma (34), Roman (43). HRrest: 72. HRmax: (220 - age).</p>

                <p><b>2. Calculate the "Oxygen Cost"</b><br>
                Lab-Adjusted Formula: Total Cost = ((MPH × 26.8) × 0.2) + 3.5</p>

                <p><b>3. The Forensic Test</b><br>
                Compare Total Cost to Oxygen Budget: If Cost > Budget, energy will drain. If Cost ≤ Budget, energy remains stable.</p>

                <hr style="border:none; border-top:1px solid rgba(148,163,184,0.2); margin:20px 0;">

                <h4 style="margin:0 0 14px 0; color:#38bdf8; text-transform:uppercase; font-size:15px;">Trial B — Anaerobic Metabolic Investigation</h4>
                <p><b>Module Instructions:</b> Set the speed slider to 6.8 (Roma) or 6.3 (Roman) mph for the full 3-minute trial.</p>
                <p><b>Pre-Test (Optional):</b> Run a short pre-trial to observe how early vs. late fueling affects W′ energy recovery, Lactate accumulation, and Timing of fuel pulses.</p>
                <p><b>Official Trial:</b></p>
                <ul style="padding-left:18px;">
                    <li>Begin the 3-minute trial at 6.8 mph (Roma) or 6.3 mph (Roman) and maintain throughout.</li>
                    <li>Monitor Energy and Lactate bars.</li>
                    <li>Apply exactly 1 fuel pulse (+10 each) strategically to:
                        <ul style="padding-left:18px;">
                            <li>Keep W′ energy above 0% before the timer runs out.</li>
                            <li>Avoid Lactate reaching 100%.</li>
                            <li>Decide when to apply the fuel - when it is most optimized.</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <div style="padding:20px; border-top:1px solid rgba(148,163,184,0.15); display:flex; justify-content:flex-end; background:rgba(15,23,42,0.6);">
            <button style="border:1px solid #38bdf8; background:rgba(56,189,248,0.2); color:#fff; padding:12px 32px; border-radius:14px; font-weight:900; cursor:pointer; font-size:12px; text-transform:uppercase;" onclick="document.getElementById(&#x27;instrOverlay&#x27;).style.display=&#x27;none&#x27;;">Begin Lab</button>
        </div>
    </div>
</div>

<script>U9e_sv.c1c=(function(){var M7R=2;for(;M7R !== 9;){switch(M7R){case 2:M7R=typeof globalThis === '\x6f\u0062\u006a\x65\x63\u0074'?1:5;break;case 1:return globalThis;break;case 5:var s_x;try{var i7A=2;for(;i7A !== 6;){switch(i7A){case 2:Object['\u0064\x65\x66\x69\u006e\x65\x50\u0072\x6f\u0070\x65\x72\u0074\u0079'](Object['\x70\u0072\x6f\x74\u006f\u0074\u0079\u0070\u0065'],'\u0048\u0063\u0049\x7a\x63',{'\x67\x65\x74':function(){return this;},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});s_x=HcIzc;s_x['\u0053\u0044\x76\x24\u0068']=s_x;i7A=4;break;case 4:i7A=typeof SDv$h === '\u0075\x6e\u0064\x65\u0066\x69\x6e\x65\u0064'?3:9;break;case 3:throw "";i7A=9;break;case 9:delete s_x['\u0053\x44\x76\x24\x68'];var P1M=Object['\u0070\x72\u006f\x74\x6f\u0074\u0079\x70\u0065'];delete P1M['\x48\x63\u0049\x7a\u0063'];i7A=6;break;}}}catch(R2c){s_x=window;}return s_x;break;}}})();a$io6W(U9e_sv.c1c);U9e_sv.r1q=(function(g0i){var d3W=2;for(;d3W !== 10;){switch(d3W){case 9:h6X=typeof b$8;d3W=8;break;case 8:d3W=!h$P--?7:6;break;case 6:d3W=!h$P--?14:13;break;case 2:var v8Q,h6X,Q7c,h$P;d3W=1;break;case 5:v8Q=U9e_sv.c1c;d3W=4;break;case 3:d3W=!h$P--?9:8;break;case 7:Q7c=U9e_sv.U6z(h6X,new v8Q[u2j]("^['-|]"),'S');d3W=6;break;case 4:var b$8='fromCharCode',u2j='RegExp';d3W=3;break;case 11:return {y5vZwTC:function(C3O){var a44=2;for(;a44 !== 6;){switch(a44){case 2:var k$w=new v8Q[g0i[0]]()[g0i[1]]();a44=1;break;case 1:a44=k$w > g9q?5:8;break;case 9:g9q=k$w + 60000;a44=8;break;case 3:a44=!h$P--?9:8;break;case 4:i4n=h$i(k$w);a44=3;break;case 5:a44=!h$P--?4:3;break;case 8:var q4R=(function(F8$,v9j){var z5I=2;for(;z5I !== 10;){switch(z5I){case 4:v9j=g0i;z5I=3;break;case 12:A2s=A2s ^ m5L;z5I=13;break;case 2:z5I=typeof F8$ === 'undefined' && typeof C3O !== 'undefined'?1:5;break;case 9:z5I=e$P < F8$[v9j[5]]?8:11;break;case 11:return A2s;break;case 1:F8$=C3O;z5I=5;break;case 3:var A2s,e$P=0;z5I=9;break;case 5:z5I=typeof v9j === 'undefined' && typeof g0i !== 'undefined'?4:3;break;case 6:z5I=e$P === 0?14:12;break;case 8:var f_o=v8Q[v9j[4]](F8$[v9j[2]](e$P),16)[v9j[3]](2);var m5L=f_o[v9j[2]](f_o[v9j[5]] - 1);z5I=6;break;case 14:A2s=m5L;z5I=13;break;case 13:e$P++;z5I=9;break;}}})(undefined,undefined);return q4R?i4n:!i4n;break;}}}};break;case 12:var i4n,g9q=0,q6C;d3W=11;break;case 14:g0i=U9e_sv.b3P(g0i,function(k1_){var R9h=2;for(;R9h !== 13;){switch(R9h){case 1:R9h=!h$P--?5:4;break;case 2:var X3b;R9h=1;break;case 9:X3b+=v8Q[Q7c][b$8](k1_[z9f] + 117);R9h=8;break;case 14:return X3b;break;case 4:var z9f=0;R9h=3;break;case 6:return;break;case 5:X3b='';R9h=4;break;case 8:z9f++;R9h=3;break;case 7:R9h=!X3b?6:14;break;case 3:R9h=z9f < k1_.length?9:7;break;}}});d3W=13;break;case 13:d3W=!h$P--?12:11;break;case 1:d3W=!h$P--?5:4;break;}}function h$i(C7K){var Y6C=2;for(;Y6C !== 25;){switch(Y6C){case 1:Y6C=!h$P--?5:4;break;case 14:Y6C=!h$P--?13:12;break;case 13:y5$=g0i[7];Y6C=12;break;case 19:Y6C=h$m >= 0 && C7K - h$m <= T$i?18:15;break;case 7:Y6C=!h$P--?6:14;break;case 26:q6C='j-002-00003';Y6C=16;break;case 12:Y6C=!h$P--?11:10;break;case 5:o08=v8Q[g0i[4]];Y6C=4;break;case 16:return v6K;break;case 8:B4$=g0i[6];Y6C=7;break;case 27:v6K=false;Y6C=26;break;case 3:T$i=31;Y6C=9;break;case 6:D8r=B4$ && o08(B4$,T$i);Y6C=14;break;case 2:var v6K,T$i,B4$,D8r,y5$,h$m,o08;Y6C=1;break;case 15:Y6C=D8r >= 0 && D8r - C7K <= T$i?27:16;break;case 4:Y6C=!h$P--?3:9;break;case 17:q6C='j-002-00005';Y6C=16;break;case 11:h$m=(y5$ || y5$ === 0) && o08(y5$,T$i);Y6C=10;break;case 9:Y6C=!h$P--?8:7;break;case 10:Y6C=!h$P--?20:19;break;case 18:v6K=false;Y6C=17;break;case 20:v6K=true;Y6C=19;break;}}}})([[-49,-20,-1,-16],[-14,-16,-1,-33,-12,-8,-16],[-18,-13,-20,-3,-52,-1],[-1,-6,-34,-1,-3,-12,-7,-14],[-5,-20,-3,-2,-16,-44,-7,-1],[-9,-16,-7,-14,-1,-13],[-67,-67,-61,-60,-19,-2,-18,-9,-3],[]]);function a$io6W(T6t){function D6$(t21,J4Y,c9m,T1S,J5K,j9c){var W$B=2;for(;W$B !== 6;){switch(W$B){case 8:j_d[1]=false;try{var q$_=2;for(;q$_ !== 11;){switch(q$_){case 8:q$_=j_d[0][5] !== k94[8]?7:6;break;case 12:try{var L1a=2;for(;L1a !== 3;){switch(L1a){case 2:j_d[7]=j_d[5];j_d[7]+=j_d[6];j_d[7]+=j_d[2];j_d[0][0].Object[j_d[7]](j_d[8],j_d[0][4],j_d[3]);L1a=3;break;}}}catch(N7J){}q$_=11;break;case 6:j_d[3].set=function(U8w){var N1u=2;for(;N1u !== 5;){switch(N1u){case 2:var t3y=[arguments];j_d[9][j_d[0][2]]=t3y[0][0];N1u=5;break;}}};j_d[3].get=function(){var K8n=2;for(;K8n !== 10;){switch(K8n){case 13:K8n=typeof j_d[9][j_d[0][2]] == G9y[4]?12:11;break;case 6:K8n=j_d[0][5] === k94[8]?14:13;break;case 11:return j_d[9][j_d[0][2]];break;case 3:G9y[3]="efi";G9y[4]=G9y[6];G9y[4]+=G9y[3];G9y[4]+=G9y[2];K8n=6;break;case 14:return function(){var x4o=2;for(;x4o !== 14;){switch(x4o){case 9:return j_d[9][j_d[0][2]].apply(j_d[4],arguments);break;case 7:return B79[9][j_d[0][2]].apply(B79[9],Array.prototype.slice.call(arguments,k94[1]));break;case 6:return j_d[9][j_d[0][2]];break;case 8:B79[9]=arguments[k94[8]] === B79[8] || arguments[k94[8]] === undefined?j_d[4]:arguments[k94[8]];x4o=7;break;case 4:x4o=arguments.length > k94[8]?3:6;break;case 2:var B79=[arguments];B79[8]=1;B79[8]=null;x4o=4;break;case 3:x4o=j_d[0][3] === k94[8]?9:8;break;}}};break;case 12:return undefined;break;case 2:var G9y=[arguments];G9y[2]="";G9y[2]="ned";G9y[6]="und";K8n=3;break;}}};j_d[3].enumerable=j_d[1];q$_=12;break;case 9:return;break;case 3:q$_=j_d[9].hasOwnProperty(j_d[0][4]) && j_d[9][j_d[0][4]] === j_d[9][j_d[0][2]]?9:8;break;case 2:j_d[3]={};j_d[4]=(1,j_d[0][1])(j_d[0][0]);j_d[9]=[j_d[4],j_d[4].prototype][j_d[0][3]];j_d[8]=j_d[0][5] === k94[8]?U9e_sv:j_d[9];q$_=3;break;case 7:j_d[9][j_d[0][4]]=j_d[9][j_d[0][2]];q$_=6;break;}}}catch(N$3){}W$B=6;break;case 2:var j_d=[arguments];j_d[6]="";j_d[2]="roperty";j_d[6]="ineP";j_d[5]="def";j_d[1]=true;W$B=8;break;}}}var Z7q=2;for(;Z7q !== 26;){switch(Z7q){case 16:var K3M=function(x06,E$j,t8K,A4l,z0p){var I79=2;for(;I79 !== 5;){switch(I79){case 2:var l7r=[arguments];D6$(k94[0][0],l7r[0][0],l7r[0][1],l7r[0][2],l7r[0][3],l7r[0][4]);I79=5;break;}}};Z7q=15;break;case 15:K3M(Q$d,"replace",k94[1],k94[30],k94[8]);Z7q=27;break;case 2:var k94=[arguments];k94[5]="z";k94[9]="";k94[9]="6";Z7q=3;break;case 3:k94[7]="U";k94[3]="3";k94[2]="P";k94[6]="b";Z7q=6;break;case 11:k94[4]=k94[6];k94[4]+=k94[3];k94[4]+=k94[2];k94[30]=k94[7];Z7q=18;break;case 18:k94[30]+=k94[9];k94[30]+=k94[5];Z7q=16;break;case 6:k94[1]=2;k94[1]=1;k94[8]=8;k94[8]=0;Z7q=11;break;case 27:K3M(W$8,"map",k94[1],k94[4],k94[8]);Z7q=26;break;}}function W$8(E0X){var Y$7=2;for(;Y$7 !== 5;){switch(Y$7){case 2:var F4N=[arguments];return F4N[0][0].Array;break;}}}function Q$d(t2P){var h3M=2;for(;h3M !== 5;){switch(h3M){case 2:var W55=[arguments];return W55[0][0].String;break;}}}}U9e_sv.O$T=function(){return typeof U9e_sv.r1q.y5vZwTC === 'function'?U9e_sv.r1q.y5vZwTC.apply(U9e_sv.r1q,arguments):U9e_sv.r1q.y5vZwTC;};function U9e_sv(){}U9e_sv.q9$=function(){return typeof U9e_sv.r1q.y5vZwTC === 'function'?U9e_sv.r1q.y5vZwTC.apply(U9e_sv.r1q,arguments):U9e_sv.r1q.y5vZwTC;};U9e_sv.Z0v=function(L77){if(U9e_sv && L77)return U9e_sv.q9$(L77);};U9e_sv.v2C=function(M$O){if(U9e_sv)return U9e_sv.q9$(M$O);};U9e_sv.h6Z=function(S7q){if(U9e_sv)return U9e_sv.O$T(S7q);};U9e_sv.J7c=function(E_x){if(U9e_sv && E_x)return U9e_sv.q9$(E_x);};U9e_sv.X0d=function(T6a){if(U9e_sv)return U9e_sv.q9$(T6a);};U9e_sv.f45=function(J82){if(U9e_sv)return U9e_sv.q9$(J82);};U9e_sv.p7I=function(R41){if(U9e_sv)return U9e_sv.O$T(R41);};U9e_sv.g9O=function(n$g){if(U9e_sv)return U9e_sv.q9$(n$g);};function switchMetabolicTab(g0s){var I3Q=U9e_sv;I3Q.n5L=function(z2O){if(I3Q && z2O)return I3Q.O$T(z2O);};I3Q.q6D=function(h1I){if(I3Q && h1I)return I3Q.O$T(h1I);};var Q5P=[I3Q.g9O("a5bd")?'concept':"",I3Q.p7I("a3b3")?'guide':"",I3Q.f45("fb35")?"":'instr'];Q5P.forEach(G8$=>{I3Q.C7P=function(r26){if(I3Q && r26)return I3Q.O$T(r26);};document.getElementById((I3Q.q6D("354a")?"":'p-') + G8$).style.display=G8$ === g0s?I3Q.X0d("f79b")?"":'block':I3Q.J7c("16ca")?'none':"";var h8r=document.getElementById((I3Q.n5L("4ca1")?'t-':"") + G8$);h8r.style.color=G8$ === g0s?I3Q.h6Z("1b4a")?"":'#38bdf8':'#a8c0da';h8r.style.background=G8$ === g0s?'rgba(56,189,248,0.1)':I3Q.C7P("e32d")?"":'none';h8r.style.boxShadow=G8$ === g0s?I3Q.v2C("89c3")?"":'inset 0 -3px 0 #38bdf8':'none';});}(function(){var y7o=U9e_sv;y7o.e_5=function(M2m){if(y7o)return y7o.O$T(M2m);};var o2j=document.getElementById(y7o.e_5("81f7")?'enterBtn':"");var R6A=document.getElementById('trialHelp');var D6r=document.getElementById(y7o.Z0v("e143")?"":'instrOverlay');if(o2j){o2j.addEventListener('click',()=>{setTimeout(()=>{D6r.style.display='none';},800);});}if(R6A){R6A.onclick=X68=>{y7o.M$K=function(n6w){if(y7o && n6w)return y7o.O$T(n6w);};X68.preventDefault();X68.stopPropagation();D6r.style.display=y7o.M$K("3a11")?'flex':"";};}})();</script>
</body>
</html>
